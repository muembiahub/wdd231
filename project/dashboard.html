<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - CodingNepal</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

    <!-- Google Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <!-- CSS -->
    <link rel="stylesheet" href="styles/admin.css" />
     <link rel="stylesheet" href="styles/base.css">
     <link rel="stylesheet" href="styles/header.css">
     <link rel="stylesheet" href="styles/mobile.css">
     <link rel="stylesheet" href="styles/tablets.css">
     <link rel="stylesheet" href="styles/desktop.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
  <script type="module" src="scripts/admin.js" defer></script>
  <script src="scripts/function.js"></script>
  <script src="./categories/scripts/catalogue.js" defer></script>
  <title>Kazidomo Confiance Home Page </title>
 
  </head>
  <header>
   <div class="dashboard-container">
      <!-- Dashboard Sidebar -->
      <aside class="dashboard-sidebar" id="dashboardSidebar">
        <div class="dashboard-brand">
          <button class="dashboard-sidebar-toggle">
            <span class="material-symbols-rounded">menu</span>
          </button>
          <a class="logo">My Dashboard</a>
        </div>

        <nav class="dashboard-nav">
          <div class="dashboard-nav-section">
            <a href="#" class="dashboard-nav-item active" data-view="overview">
              <span class="nav-icon material-symbols-rounded">dashboard</span>
              <span class="nav-label">Overview</span>
            </a>
            <a href="#" class="dashboard-nav-item" data-view="projects">
              <span class="nav-icon material-symbols-rounded">folder</span>
              <span class="nav-label">Projects</span>
            </a>
            <a href="#" class="dashboard-nav-item" data-view="tasks">
              <span class="nav-icon material-symbols-rounded">checklist</span>
              <span class="nav-label">Tasks</span>
            </a>
            <a href="#" class="dashboard-nav-item" data-view="reports">
              <span class="nav-icon material-symbols-rounded">bar_chart</span>
              <span class="nav-label">Reports</span>
            </a>
            <a href="#" class="dashboard-nav-item" data-view="settings">
              <span class="nav-icon material-symbols-rounded">settings</span>
              <span class="nav-label">Settings</span>
            </a>
          </div>
        </nav>

        <!-- Back to Site Button -->
        <div class="sidebar-footer">
          <a href="#" class="btn btn-secondary sidebar-back-button">
            <span class="material-symbols-rounded">home</span>
            <span class="btn-label">Back to Site</span>
          </a>
        </div>
      </aside>

      <div class="dashboard-sidebar-overlay" id="dashboardSidebarOverlay"></div>

      <!-- Dashboard Main Content -->
      <main class="dashboard-main">
        <!-- Dashboard Header -->
        <header class="dashboard-header">
          <!-- Header Content -->
          <div class="dashboard-header-content">
            <button class="dashboard-sidebar-toggle">
              <span class="material-symbols-rounded">menu</span>
            </button>
            <h1 class="dashboard-header-title" id="dashboardTitle">Overview</h1>
          </div>

          <!-- Search Container -->
          <div class="search-container" id="searchContainer">
            <span class="search-icon material-symbols-rounded">search</span>
            <input type="search" class="search-input form-input" placeholder="Search projects, tasks, reports..." id="searchInput" />
            <button class="search-close btn" id="searchClose">
              <span class="material-symbols-rounded">close</span>
            </button>
          </div>

          <!-- Header Actions -->
          <div class="dashboard-header-actions">
            <!-- Mobile Search Button -->
            <button class="mobile-search-btn btn btn-ghost" id="mobileSearchBtn">
              <span class="material-symbols-rounded">search</span>
            </button>

            <!-- Notification Button -->
            <div class="notification-button">
              <span class="material-symbols-rounded">notifications</span>
              <div class="notification-badge">3</div>
            </div>

            <!-- User Profile -->
            <div class="user-menu" id="userMenu">
              <div class="user-menu-trigger" id="user-menu-trigger">
                <div class="user-avatar-small">
                  <img src="user.jpg" alt="User Avatar" />
                </div>
              </div>
              <div class="user-menu-dropdown">
                <a href="#" class="user-menu-item">
                  <span class="icon material-symbols-rounded">person</span>
                  <span>Profile</span>
                </a>
                <!-- Theme Toggle inside dropdown -->
                <div class="user-menu-item theme-item">
                  <span class="icon material-symbols-rounded">palette</span>
                  <div class="theme-toggle" id="theme-toggle">
                    <div class="theme-option active" data-theme="light">Light</div>
                    <div class="theme-option" data-theme="dark">Dark</div>
                  </div>
                </div>
                <a href="#" class="user-menu-item">
                  <span class="icon material-symbols-rounded">logout</span>
                  <span>Sign Out</span>
                </a>
              </div>
            </div>
          </div>
        </header>
<body>
  <h1 id="dashboardTitle">Administration</h1>
  <div id="overview" class="dashboard-view active">
    <div class="stat-card" id="stat-demandes-recues">
      <div class="stat-card-title">Total Demandes Re√ßues</div>
      <div class="stat-card-value" id="total-demandes-value">0</div>
      <div class="stat-card-change">
        <span id="total-demandes-change">+0 cet mois dernier </span>
      </div>
    </div>
  </div>
  <div id="projects" class="dashboard-view">
  <h2>Demandes Re√ßues</h2>

  <label for="categoryFilter">Filtrer par Service :</label>
  <select id="categoryFilter">
    <option value="">Tout  les Services</option>
  </select>
  <div id="demandesContainer"></div>
</div>
 <!-- üëá gestion des utilisateurs -->
 <div id="overview" class="dashboard-nav-item" data-view="adminUsers">
    <div class="stat-card" id="stat-demandes-recues">
      <div class="dashboard-nav-item" data-view="adminUsers">Gestion des Utilisateurs</div>
      <div class="stat-card-value" id="total-demandes-value">0</div>
      <div class="stat-card-change">
        <span id="total-demandes-change">+0 cette semaine</span>
      </div>
    </div>
    <div id="adminUsers" class="dashboard-view">
  <h2>Gestion des utilisateurs</h2>
  <div id="usersContainer"></div>
</div>
  </div>

  
 




</body>
<script>
  // DOM Elements
const dashboardSidebar = document.getElementById("dashboardSidebar");
const userMenu = document.getElementById("userMenu");
const userMenuTrigger = document.getElementById("user-menu-trigger");
const userMenuDropdown = document.querySelector(".user-menu-dropdown");
const themeToggle = document.getElementById("theme-toggle");
const dashboardViews = document.querySelectorAll(".dashboard-view");
const dashboardNavItems = document.querySelectorAll(".dashboard-nav-item");
const dashboardTitle = document.getElementById("dashboardTitle");
const dashboardSidebarOverlay = document.getElementById("dashboardSidebarOverlay");
const searchContainer = document.getElementById("searchContainer");
const searchInput = document.getElementById("searchInput");
const searchClose = document.getElementById("searchClose");
const mobileSearchBtn = document.getElementById("mobileSearchBtn");

// State
let sidebarCollapsed = false;
let currentView = "overview";

// ===================================
// INITIALIZATION
// ===================================

document.addEventListener("DOMContentLoaded", function () {
  initTheme();
  initThemeToggle();
  initSidebar();
  initUserMenu();
  initNavigation();
  initSearch();
  initCharts();
});

// ===================================
// SIDEBAR FUNCTIONALITY
// ===================================

function initSidebar() {
  // Load saved sidebar state
  sidebarCollapsed = localStorage.getItem("dashboard-sidebar-collapsed") === "true";
  dashboardSidebar.classList.toggle("collapsed", sidebarCollapsed);

  // Sidebar toggle functionality
  document.querySelectorAll(".dashboard-sidebar-toggle").forEach((toggle) => {
    toggle.addEventListener("click", toggleSidebar);
  });

  // Sidebar overlay functionality
  dashboardSidebarOverlay?.addEventListener("click", closeSidebar);
}

function toggleSidebar() {
  sidebarCollapsed = !sidebarCollapsed;
  const isMobile = window.innerWidth <= 1024;

  if (isMobile) {
    // Mobile behavior - toggle sidebar and overlay together
    const isOpen = dashboardSidebar.classList.contains("collapsed");
    dashboardSidebar.classList.toggle("collapsed", !isOpen);
    dashboardSidebarOverlay?.classList.toggle("active", !isOpen);
  } else {
    // Desktop behavior
    dashboardSidebar.classList.toggle("collapsed", sidebarCollapsed);
  }

  localStorage.setItem("dashboard-sidebar-collapsed", sidebarCollapsed.toString());
}

function closeSidebar() {
  if (window.innerWidth <= 1024) {
    dashboardSidebar.classList.remove("collapsed");
    dashboardSidebarOverlay?.classList.remove("active");
  }
}

// ===================================
// USER MENU FUNCTIONALITY
// ===================================

function initUserMenu() {
  if (!userMenuTrigger || !userMenu) return;

  userMenuTrigger.addEventListener("click", (e) => {
    e.stopPropagation();
    userMenu.classList.toggle("active");
  });

  // Close menu when clicking outside or pressing escape
  document.addEventListener("click", (e) => {
    if (!userMenu.contains(e.target)) {
      userMenu.classList.remove("active");
    }
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && userMenu.classList.contains("active")) {
      userMenu.classList.remove("active");
    }
  });
}

// ===================================
// NAVIGATION FUNCTIONALITY
// ===================================

function initNavigation() {
  dashboardNavItems.forEach((item) => {
    item.addEventListener("click", (e) => {
      e.preventDefault();
      const viewId = item.getAttribute("data-view");
      if (viewId) switchView(viewId);
    });
  });
}

function switchView(viewId) {
  // Update active nav item
  dashboardNavItems.forEach((item) => {
    item.classList.toggle("active", item.getAttribute("data-view") === viewId);
  });

  // Hide all views and show selected one
  dashboardViews.forEach((view) => view.classList.remove("active"));

  const targetView = document.getElementById(viewId);
  if (targetView) {
    targetView.classList.add("active");
    currentView = viewId;
    updatePageTitle(viewId);
  }

  // Close sidebar on mobile after navigation
  if (window.innerWidth <= 1024) closeSidebar();
}

function updatePageTitle(viewId) {
  const titles = {
    overview: "Overview",
    projects: "Projects",
    tasks: "Tasks",
    reports: "Reports",
    settings: "Settings",
  };

  if (dashboardTitle) {
    dashboardTitle.textContent = titles[viewId] || "Dashboard";
  }
}

// ===================================
// THEME FUNCTIONALITY
// ===================================

function initTheme() {
  // Load saved theme
  const savedTheme = localStorage.getItem("dashboard-theme") || "light";
  document.documentElement.setAttribute("data-theme", savedTheme);

  // Update theme toggle UI
  updateThemeToggleUI(savedTheme);
}

function initThemeToggle() {
  if (!themeToggle) return;

  themeToggle.querySelectorAll(".theme-option").forEach((option) => {
    option.addEventListener("click", (e) => {
      e.stopPropagation();
      setTheme(option.getAttribute("data-theme"));
    });
  });
}

function setTheme(theme) {
  document.documentElement.setAttribute("data-theme", theme);
  localStorage.setItem("dashboard-theme", theme);
  updateThemeToggleUI(theme);
}

function updateThemeToggleUI(theme) {
  if (!themeToggle) return;

  themeToggle.querySelectorAll(".theme-option").forEach((option) => {
    option.classList.toggle("active", option.getAttribute("data-theme") === theme);
  });
}

// ===================================
// SEARCH FUNCTIONALITY
// ===================================

function initSearch() {
  mobileSearchBtn?.addEventListener("click", () => {
    searchContainer.classList.add("mobile-active");
    searchInput.focus();
  });

  searchClose?.addEventListener("click", () => {
    searchContainer.classList.remove("mobile-active");
    searchInput.value = "";
  });
}

// ===================================
// CHART INITIALIZATION
// ===================================

function initCharts() {
  initProgressChart();
  initCategoryChart();
}

function initProgressChart() {
  const ctx = document.getElementById("progressChart");
  if (!ctx) return;

  new Chart(ctx, {
    type: "line",
    data: {
      labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
      datasets: [
        {
          label: "Project Progress",
          data: [20, 35, 45, 60, 70, 85],
          borderColor: "#8b5cf6",
          backgroundColor: "rgba(139, 92, 246, 0.1)",
          borderWidth: 2,
          fill: true,
          tension: 0.4,
        },
      ],
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } },
      scales: {
        y: {
          beginAtZero: true,
          max: 100,
          ticks: { callback: (value) => value + "%" },
        },
      },
    },
  });
}

function initCategoryChart() {
  const ctx = document.getElementById("categoryChart");
  if (!ctx) return;

  new Chart(ctx, {
    type: "doughnut",
    data: {
      labels: ["Frontend", "Backend", "Mobile", "DevOps"],
      datasets: [
        {
          data: [35, 25, 20, 20],
          backgroundColor: ["#8b5cf6", "#10b981", "#f59e0b", "#ef4444"],
          borderWidth: 0,
        },
      ],
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          position: "bottom",
          labels: {
            padding: 20,
            usePointStyle: true,
          },
        },
      },
    },
  });
}

</script>
</html>